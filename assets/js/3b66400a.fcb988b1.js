"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[6865],{657:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>i,contentTitle:()=>d,default:()=>h,frontMatter:()=>a,metadata:()=>l,toc:()=>c});const l=JSON.parse('{"id":"notes/CSAPP/bomb-lab","title":"Bomb Lab \u89e3\u984c\u7b46\u8a18","description":"GDB \u5e38\u7528\u6307\u4ee4","source":"@site/docs/notes/CSAPP/bomb-lab.md","sourceDirName":"notes/CSAPP","slug":"/notes/CSAPP/bomb-lab","permalink":"/notes/docs/notes/CSAPP/bomb-lab","draft":false,"unlisted":false,"editUrl":"https://github.com/SimoneCheng/notes/tree/main/docs/notes/CSAPP/bomb-lab.md","tags":[],"version":"current","frontMatter":{"title":"Bomb Lab \u89e3\u984c\u7b46\u8a18","date":"2025-12-10T00:00:00.000Z"},"sidebar":"notes","previous":{"title":"Objects and Functions - Part 2","permalink":"/notes/docs/notes/\u514b\u670dJS\u7684\u5947\u602a\u90e8\u5206/objects-and-functions-part-2"},"next":{"title":"\u900f\u904e Docker Image \u7406\u89e3 OverlayFS","permalink":"/notes/docs/notes/Docker/understand-overlayFS-through-docker-image-layers"}}');var r=s(4848),x=s(8453);const a={title:"Bomb Lab \u89e3\u984c\u7b46\u8a18",date:new Date("2025-12-10T00:00:00.000Z")},d=void 0,i={},c=[{value:"\ud83d\udc33 GDB \u5e38\u7528\u6307\u4ee4",id:"whale-gdb-\u5e38\u7528\u6307\u4ee4",level:2},{value:"\ud83e\udd80 \u63a7\u5236\u57f7\u884c",id:"crab-\u63a7\u5236\u57f7\u884c",level:3},{value:"\ud83e\udd80 \u67e5\u770b\u7a0b\u5f0f\u78bc",id:"crab-\u67e5\u770b\u7a0b\u5f0f\u78bc",level:3},{value:"\ud83e\udd80 \u67e5\u770b\u8cc7\u6599",id:"crab-\u67e5\u770b\u8cc7\u6599",level:3},{value:"\ud83e\udd80 \u5176\u4ed6",id:"crab-\u5176\u4ed6",level:3},{value:"\ud83d\udc33 x86-64 Assembly \u57fa\u790e\u77e5\u8b58",id:"whale-x86-64-assembly-\u57fa\u790e\u77e5\u8b58",level:2},{value:"\ud83e\udd80 \u5e38\u7528\u66ab\u5b58\u5668\u8207\u7528\u9014",id:"crab-\u5e38\u7528\u66ab\u5b58\u5668\u8207\u7528\u9014",level:3},{value:"\ud83e\udd80 \u6307\u4ee4\u8a9e\u6cd5\uff08AT&amp;T \u683c\u5f0f\uff09",id:"crab-\u6307\u4ee4\u8a9e\u6cd5att-\u683c\u5f0f",level:3},{value:"\ud83e\udd80 \u8a18\u61b6\u9ad4\u5b58\u53d6\u8a9e\u6cd5",id:"crab-\u8a18\u61b6\u9ad4\u5b58\u53d6\u8a9e\u6cd5",level:3},{value:"\ud83e\udd80 \u6bd4\u8f03\u548c\u8df3\u8e8d\u6307\u4ee4",id:"crab-\u6bd4\u8f03\u548c\u8df3\u8e8d\u6307\u4ee4",level:3},{value:"\ud83e\udd80 \u5982\u4f55\u5224\u65b7\u66ab\u5b58\u5668\u662f\u4f4d\u5740\u9084\u662f\u503c",id:"crab-\u5982\u4f55\u5224\u65b7\u66ab\u5b58\u5668\u662f\u4f4d\u5740\u9084\u662f\u503c",level:3},{value:"\ud83d\udc33 Phase 1",id:"whale-phase-1",level:2},{value:"\ud83e\udd80 \u89e3\u984c\u7b56\u7565",id:"crab-\u89e3\u984c\u7b56\u7565",level:3},{value:"\ud83e\udd80 \u89e3\u6790\u6b65\u9a5f",id:"crab-\u89e3\u6790\u6b65\u9a5f",level:3},{value:"\ud83d\udc33 Phase 2",id:"whale-phase-2",level:2},{value:"\ud83e\udd80 \u89e3\u984c\u7b56\u7565",id:"crab-\u89e3\u984c\u7b56\u7565-1",level:3},{value:"\ud83e\udd80 \u89e3\u6790\u6b65\u9a5f",id:"crab-\u89e3\u6790\u6b65\u9a5f-1",level:3},{value:"\ud83d\udc33 Phase 3",id:"whale-phase-3",level:2},{value:"\ud83e\udd80 \u89e3\u984c\u7b56\u7565",id:"crab-\u89e3\u984c\u7b56\u7565-2",level:3},{value:"\ud83e\udd80 \u89e3\u6790\u6b65\u9a5f",id:"crab-\u89e3\u6790\u6b65\u9a5f-2",level:3},{value:"\ud83d\udc33 Phase 4",id:"whale-phase-4",level:2},{value:"x86-64 assembly cheat sheet",id:"x86-64-assembly-cheat-sheet",level:2}];function t(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,x.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.h2,{id:"whale-gdb-\u5e38\u7528\u6307\u4ee4",children:["\ud83d\udc33"," GDB \u5e38\u7528\u6307\u4ee4"]}),"\n",(0,r.jsxs)(n.h3,{id:"crab-\u63a7\u5236\u57f7\u884c",children:["\ud83e\udd80"," \u63a7\u5236\u57f7\u884c"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"break phase_1        # \u5728\u51fd\u6578\u8a2d\u4e2d\u65b7\u9ede\nbreak *0x400ee0      # \u5728\u7279\u5b9a\u4f4d\u5740\u8a2d\u4e2d\u65b7\u9ede\nrun                  # \u958b\u59cb\u57f7\u884c\nrun < solution.txt   # \u7528\u6a94\u6848\u8f38\u5165\u57f7\u884c\ncontinue (c)         # \u7e7c\u7e8c\u57f7\u884c\u5230\u4e0b\u500b\u4e2d\u65b7\u9ede\nni                   # \u57f7\u884c\u4e00\u689d\u6307\u4ee4\uff08\u4e0d\u9032\u5165\u51fd\u6578\uff09\nsi                   # \u57f7\u884c\u4e00\u689d\u6307\u4ee4\uff08\u6703\u9032\u5165\u51fd\u6578\uff09\n"})}),"\n",(0,r.jsxs)(n.h3,{id:"crab-\u67e5\u770b\u7a0b\u5f0f\u78bc",children:["\ud83e\udd80"," \u67e5\u770b\u7a0b\u5f0f\u78bc"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"disassemble          # \u770b\u7576\u524d\u51fd\u6578\u7684\u7d44\u8a9e\ndisassemble phase_2  # \u770b\u6307\u5b9a\u51fd\u6578\u7684\u7d44\u8a9e\nlayout asm           # \u958b\u555f\u7d44\u8a9e\u8996\u7a97\uff08\u8996\u89ba\u5316\uff09\nlayout regs          # \u986f\u793a\u66ab\u5b58\u5668\u8996\u7a97\nctrl + x, \u518d\u6309 a      # \u9000\u51fa layout\nx/i $rip             # \u770b\u7576\u524d\u8981\u57f7\u884c\u7684\u6307\u4ee4\n"})}),"\n",(0,r.jsxs)(n.h3,{id:"crab-\u67e5\u770b\u8cc7\u6599",children:["\ud83e\udd80"," \u67e5\u770b\u8cc7\u6599"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"print $rax               # \u770b\u66ab\u5b58\u5668\u7684\u503c\uff08\u5341\u9032\u4f4d\uff09\nprint/x $rax             # \u770b\u66ab\u5b58\u5668\u7684\u503c\uff08\u5341\u516d\u9032\u4f4d\uff09\ninfo registers           # \u770b\u6240\u6709\u66ab\u5b58\u5668\ninfo registers rdi rsi   # \u53ea\u986f\u793a\u7279\u5b9a\u66ab\u5b58\u5668\nx/d $rsp                 # \u770b\u8a18\u61b6\u9ad4\u5167\u5bb9\uff08\u5341\u9032\u4f4d\uff0c\u9810\u8a2d 8 bytes\uff09\nx/dw $rsp                # \u770b\u8a18\u61b6\u9ad4\u5167\u5bb9\uff08\u5341\u9032\u4f4d\uff0c4 bytes = int\uff09\nx/6d $rsp                # \u770b 6 \u500b\u6578\u5b57\nx/x $rsp                 # \u770b\u8a18\u61b6\u9ad4\u5167\u5bb9\uff08\u5341\u516d\u9032\u4f4d\uff09\nx/s 0x402400             # \u770b\u8a18\u61b6\u9ad4\u5167\u5bb9\uff08\u5b57\u4e32\uff09\nx/i $rip                 # \u770b\u8a18\u61b6\u9ad4\u5167\u5bb9\uff08\u6307\u4ee4\uff09\nx/8a 0x402470            # \u770b 8 \u500b\u4f4d\u5740\uff08\u7528\u65bc jump table\uff09\nbacktrace                # \u986f\u793a\u51fd\u6578\u547c\u53eb\u5806\u758a\uff08call stack\uff09\uff0c\u770b\u76ee\u524d\u5728\u54ea\u500b\u51fd\u6578\u3001\u662f\u88ab\u8ab0\u547c\u53eb\u7684\nbt                       # \u986f\u793a\u51fd\u6578\u547c\u53eb\u5806\u758a\uff08call stack\uff09\uff0c\u770b\u76ee\u524d\u5728\u54ea\u500b\u51fd\u6578\u3001\u662f\u88ab\u8ab0\u547c\u53eb\u7684\nwhere                    # \u986f\u793a\u51fd\u6578\u547c\u53eb\u5806\u758a\uff08call stack\uff09\uff0c\u770b\u76ee\u524d\u5728\u54ea\u500b\u51fd\u6578\u3001\u662f\u88ab\u8ab0\u547c\u53eb\u7684\n"})}),"\n",(0,r.jsxs)(n.h3,{id:"crab-\u5176\u4ed6",children:["\ud83e\udd80"," \u5176\u4ed6"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"quit (q)             # \u96e2\u958b gdb\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsxs)(n.h2,{id:"whale-x86-64-assembly-\u57fa\u790e\u77e5\u8b58",children:["\ud83d\udc33"," x86-64 Assembly \u57fa\u790e\u77e5\u8b58"]}),"\n",(0,r.jsxs)(n.h3,{id:"crab-\u5e38\u7528\u66ab\u5b58\u5668\u8207\u7528\u9014",children:["\ud83e\udd80"," \u5e38\u7528\u66ab\u5b58\u5668\u8207\u7528\u9014"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"\u51fd\u6578\u53c3\u6578\u50b3\u905e\uff08calling convention\uff09\uff1a\n%rdi  \u2192  \u7b2c 1 \u500b\u53c3\u6578\n%rsi  \u2192  \u7b2c 2 \u500b\u53c3\u6578\n%rdx  \u2192  \u7b2c 3 \u500b\u53c3\u6578\n%rcx  \u2192  \u7b2c 4 \u500b\u53c3\u6578\n%r8   \u2192  \u7b2c 5 \u500b\u53c3\u6578\n%r9   \u2192  \u7b2c 6 \u500b\u53c3\u6578\n\n\u5176\u4ed6\u91cd\u8981\u66ab\u5b58\u5668\uff1a\n%rax  \u2192  \u51fd\u6578\u8fd4\u56de\u503c\n%rsp  \u2192  stack pointer\uff08\u6307\u5411 stack \u9802\u7aef\uff09\n%rbp  \u2192  base pointer\uff08stack frame \u7684\u57fa\u6e96\uff09\n%rip  \u2192  instruction pointer\uff08\u4e0b\u4e00\u689d\u8981\u57f7\u884c\u7684\u6307\u4ee4\uff09\n"})}),"\n",(0,r.jsxs)(n.h3,{id:"crab-\u6307\u4ee4\u8a9e\u6cd5att-\u683c\u5f0f",children:["\ud83e\udd80"," \u6307\u4ee4\u8a9e\u6cd5\uff08AT&T \u683c\u5f0f\uff09"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-assembly",children:"mov    %rsp,%rsi    # \u628a %rsp \u7684\u503c\u8907\u88fd\u5230 %rsi\n                    # \u683c\u5f0f\uff1amov \u4f86\u6e90, \u76ee\u7684\u5730\nadd    %eax,%eax    # %eax = %eax + %eax\uff08\u4e58\u4ee5 2\uff09\n"})}),"\n",(0,r.jsxs)(n.h3,{id:"crab-\u8a18\u61b6\u9ad4\u5b58\u53d6\u8a9e\u6cd5",children:["\ud83e\udd80"," \u8a18\u61b6\u9ad4\u5b58\u53d6\u8a9e\u6cd5"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-assembly",children:"(%rsp)              # \u53d6 %rsp \u6307\u5411\u7684\u8a18\u61b6\u9ad4\u5167\u5bb9\n0x4(%rsp)           # \u53d6 %rsp + 4 \u7684\u8a18\u61b6\u9ad4\u5167\u5bb9\n-0x4(%rbx)          # \u53d6 %rbx - 4 \u7684\u8a18\u61b6\u9ad4\u5167\u5bb9\n0x402470(,%rax,8)   # \u8a08\u7b97\uff1a0x402470 + %rax * 8\n"})}),"\n",(0,r.jsxs)(n.h3,{id:"crab-\u6bd4\u8f03\u548c\u8df3\u8e8d\u6307\u4ee4",children:["\ud83e\udd80"," \u6bd4\u8f03\u548c\u8df3\u8e8d\u6307\u4ee4"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-assembly",children:"cmp    %eax,(%rbx)  # \u6bd4\u8f03 (%rbx) \u548c %eax\nje     \u5730\u5740          # jump if equal\uff08\u76f8\u7b49\u5c31\u8df3\uff09\njne    \u5730\u5740          # jump if not equal\uff08\u4e0d\u76f8\u7b49\u5c31\u8df3\uff09\njg     \u5730\u5740          # jump if greater\uff08\u5927\u65bc\u5c31\u8df3\uff09\nja     \u5730\u5740          # jump if above\uff08\u7121\u865f\u6578\u5927\u65bc\uff09\njbe    \u5730\u5740          # jump if below or equal\uff08\u5c0f\u65bc\u7b49\u65bc\u5c31\u8df3\uff09\n"})}),"\n",(0,r.jsxs)(n.h3,{id:"crab-\u5982\u4f55\u5224\u65b7\u66ab\u5b58\u5668\u662f\u4f4d\u5740\u9084\u662f\u503c",children:["\ud83e\udd80"," \u5982\u4f55\u5224\u65b7\u66ab\u5b58\u5668\u662f\u4f4d\u5740\u9084\u662f\u503c"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\u95dc\u9375\uff1a\u770b\u6709\u6c92\u6709\u62ec\u865f"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsxs)(n.strong,{children:["\u6709\u62ec\u865f ",(0,r.jsx)(n.code,{children:"()"})," \u2192 \u7576\u4f5c\u4f4d\u5740\u4f7f\u7528"]})}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-assembly",children:"  mov (%rsp),%eax    # \u5f9e %rsp \u6307\u5411\u7684\u4f4d\u5740\u8b80\u8cc7\u6599\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"\u6c92\u62ec\u865f \u2192 \u76f4\u63a5\u4f7f\u7528\u503c"})}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-assembly",children:"  mov %rsp,%eax      # \u628a %rsp \u7684\u503c\uff08\u4f4d\u5740\u672c\u8eab\uff09\u8907\u88fd\u7d66 %eax\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\u89c0\u5bdf\u4f7f\u7528\u6a21\u5f0f"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"add $0x4,%rbx"})," \u2014 \u6307\u6a19\u905e\u589e 4 bytes \u2192 %rbx \u662f\u4f4d\u5740"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"add %eax,%eax"})," \u2014 \u6578\u503c\u904b\u7b97 \u2192 %eax \u662f\u503c"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"lea 0x4(%rsp),%rbx"})," \u2014 Load Effective Address \u2192 \u8a08\u7b97\u4f4d\u5740\u5b58\u5230 %rbx"]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsxs)(n.h2,{id:"whale-phase-1",children:["\ud83d\udc33"," Phase 1"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"(gdb) break phase_1\nBreakpoint 1 at 0x400ee0\n(gdb) run\nStarting program: /home/simone/WorkSpace/ISLab/CSAPP/bomb/bomb \nThis GDB supports auto-downloading debuginfo from the following URLs:\n  <https://debuginfod.ubuntu.com>\nEnable debuginfod for this session? (y or [n]) y\nDebuginfod has been enabled.\nTo make this setting permanent, add 'set debuginfod enabled on' to .gdbinit.\n[Thread debugging using libthread_db enabled]\nUsing host libthread_db library \"/lib/x86_64-linux-gnu/libthread_db.so.1\".\nWelcome to my fiendish little bomb. You have 6 phases with\nwhich to blow yourself up. Have a nice day!\naaa\n\nBreakpoint 1, 0x0000000000400ee0 in phase_1 ()\n(gdb) disassemble\nDump of assembler code for function phase_1:\n=> 0x0000000000400ee0 <+0>:    sub    $0x8,%rsp\n   0x0000000000400ee4 <+4>:    mov    $0x402400,%esi\n   0x0000000000400ee9 <+9>:    call   0x401338 <strings_not_equal>\n   0x0000000000400eee <+14>:    test   %eax,%eax\n   0x0000000000400ef0 <+16>:    je     0x400ef7 <phase_1+23>\n   0x0000000000400ef2 <+18>:    call   0x40143a <explode_bomb>\n   0x0000000000400ef7 <+23>:    add    $0x8,%rsp\n   0x0000000000400efb <+27>:    ret\nEnd of assembler dump.\n"})}),"\n",(0,r.jsxs)(n.h3,{id:"crab-\u89e3\u984c\u7b56\u7565",children:["\ud83e\udd80"," \u89e3\u984c\u7b56\u7565"]}),"\n",(0,r.jsx)(n.p,{children:"\u9019\u662f\u6700\u7c21\u55ae\u7684 phase\uff0c\u4e3b\u8981\u662f\u5b57\u4e32\u6bd4\u8f03\u3002"}),"\n",(0,r.jsxs)(n.h3,{id:"crab-\u89e3\u6790\u6b65\u9a5f",children:["\ud83e\udd80"," \u89e3\u6790\u6b65\u9a5f"]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\u627e\u95dc\u9375\u53c3\u6578"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\u89c0\u5bdf ",(0,r.jsx)(n.code,{children:"mov $0x402400,%esi"})," \u9019\u884c"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"%esi"})," \u662f\u7b2c\u4e8c\u500b\u53c3\u6578\uff0c",(0,r.jsx)(n.code,{children:"0x402400"})," \u662f\u4e00\u500b\u4f4d\u5740"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\u67e5\u770b\u4f4d\u5740\u5167\u5bb9"})}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'   (gdb) x/s 0x402400\n   0x402400: "Border relations with Canada have never been better."\n'})}),"\n",(0,r.jsxs)(n.ol,{start:"3",children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\u7406\u89e3\u7a0b\u5f0f\u908f\u8f2f"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\u547c\u53eb ",(0,r.jsx)(n.code,{children:"strings_not_equal"})," \u51fd\u6578\u6bd4\u8f03\u5169\u500b\u5b57\u4e32"]}),"\n",(0,r.jsxs)(n.li,{children:["\u7b2c\u4e00\u500b\u53c3\u6578\uff08",(0,r.jsx)(n.code,{children:"%rdi"}),"\uff09\u662f\u4f60\u7684\u8f38\u5165"]}),"\n",(0,r.jsxs)(n.li,{children:["\u7b2c\u4e8c\u500b\u53c3\u6578\uff08",(0,r.jsx)(n.code,{children:"%rsi"}),"\uff09\u662f ",(0,r.jsx)(n.code,{children:"0x402400"})," \u7684\u5b57\u4e32"]}),"\n",(0,r.jsxs)(n.li,{children:["\u5982\u679c ",(0,r.jsx)(n.code,{children:"%eax == 0"}),"\uff08\u76f8\u7b49\uff09\uff0c\u5c31\u901a\u904e"]}),"\n",(0,r.jsx)(n.li,{children:"\u5426\u5247\u7206\u70b8"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.h2,{id:"whale-phase-2",children:["\ud83d\udc33"," Phase 2"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"(gdb) break phase_2\nBreakpoint 1 at 0x400efc\n(gdb) run < solution.txt \nStarting program: /home/nvidia/Desktop/bomb/bomb < solution.txt\nWelcome to my fiendish little bomb. You have 6 phases with\nwhich to blow yourself up. Have a nice day!\nPhase 1 defused. How about the next one?\n\nBreakpoint 1, 0x0000000000400efc in phase_2 ()\n(gdb) disassemble\nDump of assembler code for function phase_2:\n=> 0x0000000000400efc <+0>:\tpush   %rbp\n   0x0000000000400efd <+1>:\tpush   %rbx\n   0x0000000000400efe <+2>:\tsub    $0x28,%rsp\n   0x0000000000400f02 <+6>:\tmov    %rsp,%rsi\n   0x0000000000400f05 <+9>:\tcallq  0x40145c <read_six_numbers>\n   0x0000000000400f0a <+14>:\tcmpl   $0x1,(%rsp)\n   0x0000000000400f0e <+18>:\tje     0x400f30 <phase_2+52>\n   0x0000000000400f10 <+20>:\tcallq  0x40143a <explode_bomb>\n   0x0000000000400f15 <+25>:\tjmp    0x400f30 <phase_2+52>\n   0x0000000000400f17 <+27>:\tmov    -0x4(%rbx),%eax\n   0x0000000000400f1a <+30>:\tadd    %eax,%eax\n   0x0000000000400f1c <+32>:\tcmp    %eax,(%rbx)\n   0x0000000000400f1e <+34>:\tje     0x400f25 <phase_2+41>\n   0x0000000000400f20 <+36>:\tcallq  0x40143a <explode_bomb>\n   0x0000000000400f25 <+41>:\tadd    $0x4,%rbx\n   0x0000000000400f29 <+45>:\tcmp    %rbp,%rbx\n   0x0000000000400f2c <+48>:\tjne    0x400f17 <phase_2+27>\n   0x0000000000400f2e <+50>:\tjmp    0x400f3c <phase_2+64>\n   0x0000000000400f30 <+52>:\tlea    0x4(%rsp),%rbx\n   0x0000000000400f35 <+57>:\tlea    0x18(%rsp),%rbp\n   0x0000000000400f3a <+62>:\tjmp    0x400f17 <phase_2+27>\n   0x0000000000400f3c <+64>:\tadd    $0x28,%rsp\n   0x0000000000400f40 <+68>:\tpop    %rbx\n   0x0000000000400f41 <+69>:\tpop    %rbp\n   0x0000000000400f42 <+70>:\tretq   \nEnd of assembler dump.\n"})}),"\n",(0,r.jsxs)(n.h3,{id:"crab-\u89e3\u984c\u7b56\u7565-1",children:["\ud83e\udd80"," \u89e3\u984c\u7b56\u7565"]}),"\n",(0,r.jsx)(n.p,{children:"\u9019\u500b phase \u6aa2\u67e5 6 \u500b\u6578\u5b57\u662f\u5426\u7b26\u5408\u7279\u5b9a\u898f\u5f8b\u3002\u9700\u8981\u7406\u89e3\u8ff4\u5708\u7d50\u69cb\u3002"}),"\n",(0,r.jsxs)(n.h3,{id:"crab-\u89e3\u6790\u6b65\u9a5f-1",children:["\ud83e\udd80"," \u89e3\u6790\u6b65\u9a5f"]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\u7406\u89e3\u8f38\u5165"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\u51fd\u6578 ",(0,r.jsx)(n.code,{children:"read_six_numbers"})," \u6703\u8b80\u53d6 6 \u500b\u6574\u6578"]}),"\n",(0,r.jsxs)(n.li,{children:["\u9019\u4e9b\u6578\u5b57\u5b58\u5728 stack \u4e0a\uff08\u5f9e ",(0,r.jsx)(n.code,{children:"%rsp"})," \u958b\u59cb\uff0c\u6bcf\u500b\u4f54 4 bytes\uff09"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\u7b2c\u4e00\u500b\u6578\u5b57\u7684\u6aa2\u67e5"})}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-assembly",children:"   cmpl   $0x1,(%rsp)    # \u6bd4\u8f03 (%rsp) \u548c 1\n   je     0x400f30       # \u76f8\u7b49\u5c31\u7e7c\u7e8c\n"})}),"\n",(0,r.jsxs)(n.p,{children:["\u2192 ",(0,r.jsx)(n.strong,{children:"\u7b2c\u4e00\u500b\u6578\u5b57\u5fc5\u9808\u662f 1"})]}),"\n",(0,r.jsxs)(n.ol,{start:"3",children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\u8ff4\u5708\u908f\u8f2f\u5206\u6790"}),"\uff08\u95dc\u9375\u90e8\u5206\uff09"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-assembly",children:"   mov    -0x4(%rbx),%eax    # \u53d6\u524d\u4e00\u500b\u6578\u5b57\n   add    %eax,%eax          # %eax = %eax + %eax\uff08\u4e58\u4ee5 2\uff01\uff09\n   cmp    %eax,(%rbx)        # \u6bd4\u8f03\u7576\u524d\u6578\u5b57\u548c %eax\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"add %eax,%eax"})," \u7b49\u65bc\u628a %eax \u4e58\u4ee5 2"]}),"\n",(0,r.jsxs)(n.li,{children:["\u6bcf\u500b\u6578\u5b57\u5fc5\u9808\u662f\u524d\u4e00\u500b\u6578\u5b57\u7684 ",(0,r.jsx)(n.strong,{children:"2 \u500d"})]}),"\n"]}),"\n",(0,r.jsxs)(n.ol,{start:"4",children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"\u9a57\u8b49\u63a8\u7406"})}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"   (gdb) x/6d $rsp      # \u67e5\u770b\u8f38\u5165\u7684 6 \u500b\u6578\u5b57\n   (gdb) ni             # \u55ae\u6b65\u57f7\u884c\n   (gdb) print $eax     # \u89c0\u5bdf\u8a08\u7b97\u7d50\u679c\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"5",children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\u63a8\u7b97\u6578\u5217"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u7b2c 1 \u500b\uff1a1"}),"\n",(0,r.jsx)(n.li,{children:"\u7b2c 2 \u500b\uff1a1 \xd7 2 = 2"}),"\n",(0,r.jsx)(n.li,{children:"\u7b2c 3 \u500b\uff1a2 \xd7 2 = 4"}),"\n",(0,r.jsx)(n.li,{children:"\u7b2c 4 \u500b\uff1a4 \xd7 2 = 8"}),"\n",(0,r.jsx)(n.li,{children:"\u7b2c 5 \u500b\uff1a8 \xd7 2 = 16"}),"\n",(0,r.jsx)(n.li,{children:"\u7b2c 6 \u500b\uff1a16 \xd7 2 = 32"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.h2,{id:"whale-phase-3",children:["\ud83d\udc33"," Phase 3"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"(gdb) break phase_3\nBreakpoint 1 at 0x400f43\n(gdb) run solution.txt \nStarting program: /home/nvidia/Desktop/bomb/bomb solution.txt\nWelcome to my fiendish little bomb. You have 6 phases with\nwhich to blow yourself up. Have a nice day!\nPhase 1 defused. How about the next one?\nThat's number 2.  Keep going!\n\nBreakpoint 1, 0x0000000000400f43 in phase_3 ()\n(gdb) layout asm\n(gdb) disassemble\nNo frame selected.\n(gdb) run solution.txt \nStarting program: /home/nvidia/Desktop/bomb/bomb solution.txt\nWelcome to my fiendish little bomb. You have 6 phases with\nwhich to blow yourself up. Have a nice day!\nPhase 1 defused. How about the next one?\nThat's number 2.  Keep going!\n\nBreakpoint 1, 0x0000000000400f43 in phase_3 ()\n(gdb) disassemble\nDump of assembler code for function phase_3:\n=> 0x0000000000400f43 <+0>:\tsub    $0x18,%rsp\n   0x0000000000400f47 <+4>:\tlea    0xc(%rsp),%rcx\n   0x0000000000400f4c <+9>:\tlea    0x8(%rsp),%rdx\n   0x0000000000400f51 <+14>:\tmov    $0x4025cf,%esi\n   0x0000000000400f56 <+19>:\tmov    $0x0,%eax\n   0x0000000000400f5b <+24>:\tcallq  0x400bf0 <__isoc99_sscanf@plt>\n   0x0000000000400f60 <+29>:\tcmp    $0x1,%eax\n   0x0000000000400f63 <+32>:\tjg     0x400f6a <phase_3+39>\n   0x0000000000400f65 <+34>:\tcallq  0x40143a <explode_bomb>\n   0x0000000000400f6a <+39>:\tcmpl   $0x7,0x8(%rsp)\n   0x0000000000400f6f <+44>:\tja     0x400fad <phase_3+106>\n   0x0000000000400f71 <+46>:\tmov    0x8(%rsp),%eax\n   0x0000000000400f75 <+50>:\tjmpq   *0x402470(,%rax,8)\n   0x0000000000400f7c <+57>:\tmov    $0xcf,%eax\n   0x0000000000400f81 <+62>:\tjmp    0x400fbe <phase_3+123>\n   0x0000000000400f83 <+64>:\tmov    $0x2c3,%eax\n   0x0000000000400f88 <+69>:\tjmp    0x400fbe <phase_3+123>\n   0x0000000000400f8a <+71>:\tmov    $0x100,%eax\n   0x0000000000400f8f <+76>:\tjmp    0x400fbe <phase_3+123>\n   0x0000000000400f91 <+78>:\tmov    $0x185,%eax\n   0x0000000000400f96 <+83>:\tjmp    0x400fbe <phase_3+123>\n   0x0000000000400f98 <+85>:\tmov    $0xce,%eax\n   0x0000000000400f9d <+90>:\tjmp    0x400fbe <phase_3+123>\n   0x0000000000400f9f <+92>:\tmov    $0x2aa,%eax\n   0x0000000000400fa4 <+97>:\tjmp    0x400fbe <phase_3+123>\n   0x0000000000400fa6 <+99>:\tmov    $0x147,%eax\n   0x0000000000400fab <+104>:\tjmp    0x400fbe <phase_3+123>\n   0x0000000000400fad <+106>:\tcallq  0x40143a <explode_bomb>\n   0x0000000000400fb2 <+111>:\tmov    $0x0,%eax\n   0x0000000000400fb7 <+116>:\tjmp    0x400fbe <phase_3+123>\n   0x0000000000400fb9 <+118>:\tmov    $0x137,%eax\n   0x0000000000400fbe <+123>:\tcmp    0xc(%rsp),%eax\n   0x0000000000400fc2 <+127>:\tje     0x400fc9 <phase_3+134>\n   0x0000000000400fc4 <+129>:\tcallq  0x40143a <explode_bomb>\n   0x0000000000400fc9 <+134>:\tadd    $0x18,%rsp\n   0x0000000000400fcd <+138>:\tretq   \nEnd of assembler dump.\n\n"})}),"\n",(0,r.jsxs)(n.h3,{id:"crab-\u89e3\u984c\u7b56\u7565-2",children:["\ud83e\udd80"," \u89e3\u984c\u7b56\u7565"]}),"\n",(0,r.jsx)(n.p,{children:"\u9019\u500b phase \u4f7f\u7528 switch-case \u7d50\u69cb\uff0c\u6839\u64da\u7b2c\u4e00\u500b\u6578\u5b57\u6c7a\u5b9a\u7b2c\u4e8c\u500b\u6578\u5b57\u7684\u503c\u3002\u6709 8 \u7d44\u53ef\u80fd\u7684\u7b54\u6848\u3002"}),"\n",(0,r.jsxs)(n.h3,{id:"crab-\u89e3\u6790\u6b65\u9a5f-2",children:["\ud83e\udd80"," \u89e3\u6790\u6b65\u9a5f"]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"\u7406\u89e3\u8f38\u5165\u683c\u5f0f"})}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'(gdb) x/s 0x4025cf\n0x4025cf: "%d %d"\n'})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"sscanf"})," \u8b80\u53d6",(0,r.jsx)(n.strong,{children:"\u5169\u500b\u6574\u6578"})]}),"\n",(0,r.jsxs)(n.li,{children:["\u53c3\u6578\u6e96\u5099\uff1a","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"%rdi"}),"\uff1a\u8f38\u5165\u5b57\u4e32\uff08\u4f60\u6253\u7684\u5167\u5bb9\uff09"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"%rsi"}),"\uff1a\u683c\u5f0f\u5b57\u4e32 ",(0,r.jsx)(n.code,{children:'"%d %d"'})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"%rdx"}),"\uff1a\u7b2c\u4e00\u500b\u6574\u6578\u7684\u5132\u5b58\u4f4d\u5740\uff08",(0,r.jsx)(n.code,{children:"%rsp+8"}),"\uff09"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"%rcx"}),"\uff1a\u7b2c\u4e8c\u500b\u6574\u6578\u7684\u5132\u5b58\u4f4d\u5740\uff08",(0,r.jsx)(n.code,{children:"%rsp+12"}),"\uff09"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.ol,{start:"2",children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"\u7b2c\u4e00\u500b\u6578\u5b57\u7684\u7bc4\u570d\u9650\u5236"})}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-assembly",children:"cmpl   $0x7,0x8(%rsp)    # \u6bd4\u8f03\u7b2c\u4e00\u500b\u6578\u5b57\u548c 7\nja     0x400fad          # \u5982\u679c\u5927\u65bc\u5c31\u7206\u70b8\n"})}),"\n",(0,r.jsxs)(n.p,{children:["\u2192 ",(0,r.jsxs)(n.strong,{children:["\u7b2c\u4e00\u500b\u6578\u5b57\u5fc5\u9808 ",(0,r.jsx)(n.code,{children:"<="})," 7"]}),"\uff08\u5373 0-7\uff09"]}),"\n",(0,r.jsxs)(n.ol,{start:"3",children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"Jump Table \u7684\u904b\u4f5c\u539f\u7406"})}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-assembly",children:"jmpq   *0x402470(,%rax,8)\n"})}),"\n",(0,r.jsxs)(n.p,{children:["\u9019\u662f",(0,r.jsx)(n.strong,{children:"\u9593\u63a5\u8df3\u8e8d"}),"\uff0c\u5be6\u73fe switch-case\uff1a"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"%rax"})," = \u7b2c\u4e00\u500b\u6578\u5b57\uff080-7\uff09"]}),"\n",(0,r.jsxs)(n.li,{children:["\u8a08\u7b97\u4f4d\u5740\uff1a",(0,r.jsx)(n.code,{children:"0x402470 + %rax * 8"})]}),"\n",(0,r.jsxs)(n.li,{children:["\u5f9e\u8a72\u4f4d\u5740",(0,r.jsx)(n.strong,{children:"\u8b80\u53d6\u8df3\u8e8d\u76ee\u6a19"}),"\uff0c\u7136\u5f8c\u8df3\u904e\u53bb"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\u67e5\u770b Jump Table\uff1a"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"(gdb) x/8a 0x402470\n0x402470:  0x400f7c     # case 0\n0x402478:  0x400fb9     # case 1\n0x402480:  0x400f83     # case 2\n0x402488:  0x400f8a     # case 3\n0x402490:  0x400f91     # case 4\n0x402498:  0x400f98     # case 5\n0x4024a0:  0x400f9f     # case 6\n0x4024a8:  0x400fa6     # case 7\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"4",children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"\u5404\u500b Case \u7684\u7d50\u69cb"})}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"\u6bcf\u500b case \u90fd\u505a\u4e00\u6a23\u7684\u4e8b\uff1a"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-assembly",children:"mov    $\u67d0\u500b\u6578\u5b57,%eax     # \u628a\u671f\u671b\u503c\u653e\u5230 %eax\njmp    0x400fbe          # \u8df3\u5230\u5171\u540c\u6aa2\u67e5\u9ede\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"5",children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"\u5171\u540c\u6aa2\u67e5\u9ede\uff1a"})}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-assembly",children:"cmp    0xc(%rsp),%eax    # \u6bd4\u8f03 %eax \u548c\u7b2c\u4e8c\u500b\u8f38\u5165 (%rsp+12)\nje     0x400fc9          # \u76f8\u7b49\u5c31\u901a\u904e\ncallq  explode_bomb      # \u5426\u5247\u7206\u70b8\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"6",children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"\u627e\u51fa\u5c0d\u61c9\u95dc\u4fc2"})}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"\u5f9e\u7d44\u8a9e\u4e2d\u53ef\u4ee5\u770b\u5230 8 \u500b case \u7684\u671f\u671b\u503c\uff08\u5341\u516d\u9032\u4f4d\uff09\uff1a"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Case"}),(0,r.jsx)(n.th,{children:"\u7d44\u8a9e\u4f4d\u7f6e"}),(0,r.jsx)(n.th,{children:"%eax \u503c\uff08hex\uff09"}),(0,r.jsx)(n.th,{children:"\u8f49\u6210\u5341\u9032\u4f4d"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"0"}),(0,r.jsx)(n.td,{children:"+57"}),(0,r.jsx)(n.td,{children:"0xcf"}),(0,r.jsx)(n.td,{children:"207"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"1"}),(0,r.jsx)(n.td,{children:"+118"}),(0,r.jsx)(n.td,{children:"0x137"}),(0,r.jsx)(n.td,{children:"311"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"2"}),(0,r.jsx)(n.td,{children:"+64"}),(0,r.jsx)(n.td,{children:"0x2c3"}),(0,r.jsx)(n.td,{children:"707"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"3"}),(0,r.jsx)(n.td,{children:"+71"}),(0,r.jsx)(n.td,{children:"0x100"}),(0,r.jsx)(n.td,{children:"256"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"4"}),(0,r.jsx)(n.td,{children:"+78"}),(0,r.jsx)(n.td,{children:"0x185"}),(0,r.jsx)(n.td,{children:"389"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"5"}),(0,r.jsx)(n.td,{children:"+85"}),(0,r.jsx)(n.td,{children:"0xce"}),(0,r.jsx)(n.td,{children:"206"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"6"}),(0,r.jsx)(n.td,{children:"+92"}),(0,r.jsx)(n.td,{children:"0x2aa"}),(0,r.jsx)(n.td,{children:"682"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"7"}),(0,r.jsx)(n.td,{children:"+99"}),(0,r.jsx)(n.td,{children:"0x147"}),(0,r.jsx)(n.td,{children:"327"})]})]})]}),"\n",(0,r.jsxs)(n.h2,{id:"whale-phase-4",children:["\ud83d\udc33"," Phase 4"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"(gdb) break phase_4\nBreakpoint 1 at 0x40100c\n(gdb) run solution.txt \nStarting program: /home/simone/WorkSpace/ISLab/CSAPP/bomb/bomb solution.txt\n\nThis GDB supports auto-downloading debuginfo from the following URLs:\n  <https://debuginfod.ubuntu.com>\nEnable debuginfod for this session? (y or [n]) y\nDebuginfod has been enabled.\nTo make this setting permanent, add 'set debuginfod enabled on' to .gdbinit.\n[Thread debugging using libthread_db enabled]\nUsing host libthread_db library \"/lib/x86_64-linux-gnu/libthread_db.so.1\".\nWelcome to my fiendish little bomb. You have 6 phases with\nwhich to blow yourself up. Have a nice day!\nPhase 1 defused. How about the next one?\nThat's number 2.  Keep going!\nHalfway there!\n1\n\nBreakpoint 1, 0x000000000040100c in phase_4 ()\n(gdb) disassemble\nDump of assembler code for function phase_4:\n=> 0x000000000040100c <+0>:\tsub    $0x18,%rsp\n   0x0000000000401010 <+4>:\tlea    0xc(%rsp),%rcx\n   0x0000000000401015 <+9>:\tlea    0x8(%rsp),%rdx\n   0x000000000040101a <+14>:\tmov    $0x4025cf,%esi\n   0x000000000040101f <+19>:\tmov    $0x0,%eax\n   0x0000000000401024 <+24>:\tcall   0x400bf0 <__isoc99_sscanf@plt>\n   0x0000000000401029 <+29>:\tcmp    $0x2,%eax\n   0x000000000040102c <+32>:\tjne    0x401035 <phase_4+41>\n   0x000000000040102e <+34>:\tcmpl   $0xe,0x8(%rsp)\n   0x0000000000401033 <+39>:\tjbe    0x40103a <phase_4+46>\n   0x0000000000401035 <+41>:\tcall   0x40143a <explode_bomb>\n   0x000000000040103a <+46>:\tmov    $0xe,%edx\n   0x000000000040103f <+51>:\tmov    $0x0,%esi\n   0x0000000000401044 <+56>:\tmov    0x8(%rsp),%edi\n   0x0000000000401048 <+60>:\tcall   0x400fce <func4>\n   0x000000000040104d <+65>:\ttest   %eax,%eax\n   0x000000000040104f <+67>:\tjne    0x401058 <phase_4+76>\n   0x0000000000401051 <+69>:\tcmpl   $0x0,0xc(%rsp)\n   0x0000000000401056 <+74>:\tje     0x40105d <phase_4+81>\n   0x0000000000401058 <+76>:\tcall   0x40143a <explode_bomb>\n   0x000000000040105d <+81>:\tadd    $0x18,%rsp\n   0x0000000000401061 <+85>:\tret\nEnd of assembler dump.\n"})}),"\n",(0,r.jsx)(n.h2,{id:"x86-64-assembly-cheat-sheet",children:"x86-64 assembly cheat sheet"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://web.stanford.edu/class/cs107/resources/x86-64-reference.pdf",children:"https://web.stanford.edu/class/cs107/resources/x86-64-reference.pdf"})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,x.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(t,{...e})}):t(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>a,x:()=>d});var l=s(6540);const r={},x=l.createContext(r);function a(e){const n=l.useContext(x);return l.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),l.createElement(x.Provider,{value:n},e.children)}}}]);